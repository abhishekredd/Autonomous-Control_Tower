services:
  - type: web
    name: api
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.api

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: SECRET_KEY
        sync: false
      - key: DEBUG
        sync: false

  - type: worker
    name: celery-worker
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.api

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  - type: worker
    name: celery-beat
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.api

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  - type: worker
    name: mcp-risk-detector
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.mcp

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  - type: worker
    name: mcp-route-optimizer
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.mcp

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false

  - type: worker
    name: mcp-stakeholder-comms
    env: docker
    plan: free
    dockerfilePath: docker/Dockerfile.mcp

    envVars:
      - key: DATABASE_URL
        sync: false
      - key: REDIS_URL
        sync: false
      - key: OPENAI_API_KEY
        sync: false

  - type: web
    name: frontend
    env: docker
    plan: free
    dockerfilePath: frontend/Dockerfile

    envVars:
      - key: API_URL
        value: https://api.onrender.com
